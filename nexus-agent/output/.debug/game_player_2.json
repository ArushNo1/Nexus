{
  "lesson_plan": {
    "lessonPlan": {
      "title": "Introduction to Photosynthesis",
      "duration": "60 minutes",
      "gradeLevel": "Level: 5th Grade",
      "subject": "Science",
      "objectives": [
        "Students will be able to define photosynthesis.",
        "Students will identify the inputs (sunlight, water, carbon dioxide) and outputs (oxygen, glucose) of photosynthesis.",
        "Students will explain the importance of photosynthesis for life on Earth."
      ],
      "standards": [
        "NGSS 5-LS1-1: Support an argument that plants get the materials they need for growth chiefly from air and water."
      ],
      "materials": [
        "Could not extract materials"
      ],
      "content": {
        "introduction": "Could not extract introduction",
        "procedure": "Could not extract procedure",
        "closure": "Could not extract closure"
      }
    },
    "rubrics": {
      "title": "Extracted Rubric",
      "criteria": []
    },
    "assessments": [
      {
        "type": "Extracted Assessment",
        "title": "Assessment",
        "questions": [
          {
            "questionText": "- Formative: participation in Thumbs Up/Thumbs Down.\n- Summative: Plant diagram worksheet accuracy.\n- Quiz (to be given next class):\n  1. What gas do plants take in? (Carbon Dioxide)\n  2. What gas do plants release? (Oxygen)\n  3. What is the main source of energy for plants? (Sunlight)",
            "options": [],
            "correctAnswer": "",
            "points": 0
          }
        ]
      }
    ]
  },
  "game_type": "shootemup",
  "template_code": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Kaplay Shoot 'em Up Template</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n        }\n\n        body {\n            background: #000;\n            overflow: hidden;\n        }\n\n        canvas {\n            display: block;\n        }\n    </style>\n</head>\n\n<body>\n    <script src=\"https://unpkg.com/kaplay@3001.0.19/dist/kaplay.js\"></script>\n    <script>\n        // =============================================\n        //  SHOOT 'EM UP TEMPLATE \u2014 Kaplay.js\n        //  Arrow keys / WASD move, Z / Space to shoot\n        //\n        //  ARCHITECTURE:\n        //    Two scenes: \"game\" (main gameplay) and \"gameover\" (score display + retry).\n        //    Tags used: \"star\", \"player\", \"pbullet\" (player bullets), \"enemy\", \"ebullet\" (enemy bullets).\n        //    Difficulty scales with score \u2014 spawn rate increases over time.\n        //    Player has HP + invulnerability frames on hit. Three enemy types: basic, fast (zigzag), tank (shoots back).\n        // =============================================\n\n        // -- CONFIG: All tunable gameplay constants live here --\n        const C = {\n            playerSpeed: 280,\n            bulletSpeed: 600,\n            fireRate: 0.12,       // seconds between player shots (lower = faster)\n            playerHP: 5,\n            spawnRate: 1.2,       // base seconds between enemy spawns (divided by difficulty multiplier)\n            enemySpeed: [80, 200],  // [min, max] for rand()\n            enemyHP: [1, 3],\n            enemyFireRate: 1.5,   // seconds between tank enemy shots\n            enemyBulletSpd: 250,\n            bg: [6, 6, 18],\n            playerCol: [80, 220, 255],\n            bulletCol: [255, 255, 120],\n            enemyBulletCol: [255, 100, 100],\n        };\n\n        // -- INIT: 480x700 portrait canvas, letterboxed to fit window --\n        kaplay({ width: 480, height: 700, background: C.bg, crisp: true, letterbox: true });\n        l\n... [truncated, 13505 chars total]",
  "game_design_doc": "GAME_TYPE: shootemup\n\nRATIONALE: The shootemup genre is ideal for photosynthesis because it mirrors the constant, rapid bombardment of molecules and energy a leaf experiences. It requires students to perform rapid identification and categorization of \"Inputs\" versus \"Outputs\" in a high-energy environment.\n\nADDON FEATURE: The Photosynthesis Recipe Meter\nA UI meter tracks three specific \"Input\" slots: Sunlight, Water, and Carbon Dioxide. The player must fly into these specific items as they fall down the screen to fill the slots; however, \"Output\" items (Oxygen and Glucose) also fall and must be avoided. Once all three inputs are collected, the player\u2019s ship (the Chloroplast) automatically emits a \"Growth Pulse\" that clears all \"Pollution\" enemies on screen and earns a point, reinforcing that these three specific ingredients are required to produce a result.\n\nVISUAL THEME: The player controls a \"Super Chloroplast\" craft navigating the microscopic interior of a leaf cell. Enemies are dark \"Smog Clouds\" and \"Pests,\" while the items to collect or avoid are bright yellow Suns, blue Water droplets, grey CO2 molecules, and hexagonal Glucose sugars.",
  "design_feedback": "1. **Genre Fit** (4/5) \u2014 The shootemup genre effectively captures the dynamic exchange of molecules, though the \"avoidance\" of outputs is a slightly artificial game constraint compared to the real biological process.\n2. **Pedagogical Alignment** (5/5) \u2014 The \"Recipe Meter\" perfectly reinforces the lesson's goal of distinguishing specific inputs (Sun, Water, CO2) from outputs by making the player actively select one and reject the other.\n3. **Addon Feasibility** (5/5) \u2014 Implementing a collection-based UI meter and a screen-clearing \"Growth Pulse\" effect is a standard mechanic that is highly feasible within the Kaplay engine.\n4. **Visual Theme Coherence** (4/5) \u2014 Using a chloroplast pilot and molecular collectibles creates a strong mental link to cellular biology, though labeling Oxygen as an obstacle to avoid may require a brief explanation to ensure students don't think it's \"bad.\"\n5. **Fun Factor** (5/5) \u2014 The mechanic turns a core learning objective into a high-stakes \"super move\" charge-up, making the science feel like an empowering gameplay reward rather than an interruption.\n\n**DECISION: PASS**",
  "design_approved": true,
  "implementation_plan": "This technical plan transforms the standard shoot 'em up into **\"Chloroplast Command,\"** an educational game where students manage the inputs of photosynthesis while defending a leaf cell from pollution.\n\n---\n\n### 1. Visual Reskin Plan\n\n#### Environment & Background\n*   **Background Color**: Change `C.bg` from `[6, 6, 18]` (dark blue) to **`[10, 35, 15]`** (deep forest green) to represent the interior of a plant cell.\n*   **Starfield (Cytoplasmic Flow)**: Rename `makeStars()` to `makeCellFlow()`.\n    *   **Change**: Change star color from `[255, 255, 255]` to `[120, 200, 100]` (light green).\n    *   **Change**: Change `circle(s)` to `rect(s, s)` to look like microscopic cell debris.\n*   **HUD Text**: Change `hpTxt` color to `[150, 255, 150]`. Change heart symbol `@` to a leaf symbol `\u2618`.\n\n#### Game Objects\n*   **Player (Super Chloroplast)**: \n    *   **Now**: `sprite(\"bean\")` with blue tint.\n    *   **Become**: `sprite(\"bean\")` with **`color(50, 200, 50)`** (bright green).\n    *   **Scale**: Increase to `1.5` to look like a sturdy organelle.\n*   **Enemies (Pollution & Pests)**:\n    *   **Basic (Smog Cloud)**: Change color to `[100, 100, 100]` (Grey).\n    *   **Fast (Pest/Aphid)**: Change color to `[200, 50, 50]` (Red).\n    *   **Tank (Industrial Soot)**: Change color to `[40, 40, 40]` (Near-black) and increase size to `40x40`.\n*   **Projectiles**:\n    *   **Player Bullets (Energy)**: Change `C.bulletCol` to `[200, 255, 0]` (Bright Lime).\n    *   **Enemy Bullets (Toxins)**: Change `C.enemyBulletCol` to `[180, 0, 255]` (Purple).\n\n---\n\n### 2. Addon Mechanic Implementation Plan: Photosynthesis Recipe Meter\n\n#### A. State Management\nIn the `scene(\"game\")`, initialize a state object to track the three inputs:\n```javascript\nlet recipe = { sun: false, water: false, co2: false };\nconst recipeTotal = 3;\n```\n\n#### B. New Game Objects: Inputs & Outputs\nCreate a new function `spawnMolecules()` that triggers on a separate timer (similar to `spawnEnemy`).\n*   **Inputs**:\n    *   `\n... [truncated, 4946 chars total]",
  "game_code": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Chloroplast Command: Photosynthesis Shooter</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n        }\n\n        body {\n            background: #000;\n            overflow: hidden;\n            font-family: sans-serif;\n        }\n\n        canvas {\n            display: block;\n            margin: 0 auto;\n        }\n    </style>\n</head>\n\n<body>\n    <!-- KAPLAY CDN -->\n    <script src=\"https://unpkg.com/kaplay@3001.0.19/dist/kaplay.js\"></script>\n    <script>\n        // =============================================\n        //  CHLOROPLAST COMMAND \u2014 Photosynthesis Shooter\n        //  Collect Inputs (Sun, H2O, CO2) to trigger Growth Pulse.\n        //  Avoid Outputs (O2, Glucose) to prevent clogging.\n        //  Shoot Pollution enemies.\n        // =============================================\n\n        // -- CONFIG: Gameplay Constants --\n        const C = {\n            playerSpeed: 280,\n            bulletSpeed: 600,\n            fireRate: 0.12,\n            playerHP: 5,\n            spawnRate: 1.2,       // Enemy spawn rate\n            moleculeSpawnRate: 1.5, // Ingredient spawn rate\n            enemySpeed: [80, 200],\n            enemyHP: [1, 3],\n            enemyFireRate: 1.5,\n            enemyBulletSpd: 250,\n            // Visual Palette\n            bg: [10, 35, 15],             // Deep Forest Green\n            playerCol: [50, 200, 50],     // Chloroplast Green\n            bulletCol: [200, 255, 0],     // Bright Lime Energy\n            enemyBulletCol: [180, 0, 255],// Toxic Purple\n            cloggedCol: [150, 150, 150],  // Greyed out (clogged state)\n        };\n\n        // -- INIT --\n        kaplay({ \n            width: 480, \n            height: 700, \n            background: C.bg, \n            crisp: true, \n            letterbox: true \n        });\n        \n        loadBean(); // Base sprite for player\n\n        // -- CELL FLOW: Decorative background (Cytoplasm) --\n        f\n... [truncated, 20025 chars total]",
  "documentation": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Chloroplast Command: Photosynthesis Shooter</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n        }\n\n        body {\n            background: #000;\n            overflow: hidden;\n            font-family: sans-serif;\n        }\n\n        canvas {\n            display: block;\n            margin: 0 auto;\n        }\n    </style>\n</head>\n\n<body>\n    <!-- KAPLAY CDN -->\n    <script src=\"https://unpkg.com/kaplay@3001.0.19/dist/kaplay.js\"></script>\n    <script>\n        // =============================================\n        //  CHLOROPLAST COMMAND \u2014 Photosynthesis Shooter\n        //  Collect Inputs (Sun, H2O, CO2) to trigger Growth Pulse.\n        //  Avoid Outputs (O2, Glucose) to prevent clogging.\n        //  Shoot Pollution enemies.\n        // =============================================\n\n        // -- CONFIG: Gameplay Constants --\n        const C = {\n            playerSpeed: 280,\n            bulletSpeed: 600,\n            fireRate: 0.12,\n            playerHP: 5,\n            spawnRate: 1.2,       // Enemy spawn rate\n            moleculeSpawnRate: 1.5, // Ingredient spawn rate\n            enemySpeed: [80, 200],\n            enemyHP: [1, 3],\n            enemyFireRate: 1.5,\n            enemyBulletSpd: 250,\n            // Visual Palette\n            bg: [10, 35, 15],             // Deep Forest Green\n            playerCol: [50, 200, 50],     // Chloroplast Green\n            bulletCol: [200, 255, 0],     // Bright Lime Energy\n            enemyBulletCol: [180, 0, 255],// Toxic Purple\n            cloggedCol: [150, 150, 150],  // Greyed out (clogged state)\n        };\n\n        // -- INIT --\n        kaplay({ \n            width: 480, \n            height: 700, \n            background: C.bg, \n            crisp: true, \n            letterbox: true \n        });\n        \n        loadBean(); // Base sprite for player\n\n        // -- CELL FLOW: Decorative background (Cytoplasm) --\n        f\n... [truncated, 20025 chars total]",
  "playtest_report": "# QA Evaluation Report: Chloroplast Command\n\n## 1. Static Analysis\n- **HTML Structure:** Valid.\n- **Kaplay CDN:** Correct (v3001.0.19).\n- **Syntax Errors:** None detected. \n- **Object Definitions:** All game objects (`player`, `enemy`, `molecules`, `pbullet`) are correctly initialized with required components (`pos`, `area`, `body` is not needed as it's a top-down shooter, `move` is used correctly).\n- **Score: 5/5**\n\n## 2. Code Quality Review\n- **Initialization:** `kaplay()` config is well-defined with appropriate resolution (480x700) and background.\n- **Scene Management:** Two distinct scenes (\"game\", \"gameover\") are defined and transitioned correctly.\n- **Logic:** \n    - Movement is handled for both WASD and Arrow keys.\n    - Collision logic uses tags effectively.\n    - The \"Clogged\" state (shooting penalty) is implemented with a timer and visual feedback (color change).\n    - The `onUpdate` cleanup for offscreen enemies prevents memory leaks.\n- **Headless Browser Warnings:** The `GPU stall due to ReadPixels` warnings are performance hints typically related to the headless browser's rendering/capture pipeline in a virtualized environment, not a bug in the JavaScript source code itself.\n- **Score: 5/5**\n\n## 3. Educational Alignment\n- **GDD Match:** The game follows the GDD perfectly. The \"Recipe Meter\" is the core mechanic, and the \"Growth Pulse\" reward for collecting Sunlight, Water, and CO2 is implemented.\n- **Learning Objectives:** \n    - **Inputs vs. Outputs:** The game clearly distinguishes between what the chloroplast needs (Inputs) and what it produces/releases (Outputs). \n    - **Categorization:** By penalizing the collection of Glucose and Oxygen (clogging), players learn that these are products, not fuel for the process.\n- **Documentation:** Controls and objectives are visible at the bottom of the screen during gameplay.\n- **Score: 5/5**\n\n## 4. Playability Assessment\n- **State Flow:** Clear progression from Start -> Game -> Game Over -> Retry.\n- **Control\n... [truncated, 2848 chars total]",
  "ship_approved": true,
  "errors": [
    "NONE FOUND."
  ],
  "design_iteration": 1,
  "code_iteration": 1,
  "status": "done"
}