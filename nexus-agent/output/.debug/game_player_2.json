{
  "lesson_plan": {
    "lessonPlan": {
      "title": "Introduction to the American Civil War",
      "duration": "60 minutes",
      "gradeLevel": "Level: 8th Grade",
      "subject": "Social Studies/History",
      "objectives": [
        "Students will be able to identify the main causes of the Civil War (slavery, states' rights, economic differences).",
        "Students will explain the differences between the Union and Confederate states.",
        "Students will describe key events and outcomes of the Civil War.",
        "Students will understand the significance of the Civil War in American history."
      ],
      "standards": [
        "CCSS.ELA-LITERACY.RH.6-8.2: Determine the central ideas or information of a primary or secondary source.",
        "NCSS Theme 2: Time, Continuity, and Change - Understanding causes and effects of historical events."
      ],
      "materials": [
        "Could not extract materials"
      ],
      "content": {
        "introduction": "Could not extract introduction",
        "procedure": "Could not extract procedure",
        "closure": "Could not extract closure"
      }
    },
    "rubrics": {
      "title": "Extracted Rubric",
      "criteria": []
    },
    "assessments": [
      {
        "type": "Extracted Assessment",
        "title": "Assessment",
        "questions": [
          {
            "questionText": "- Formative: participation in class discussion about causes of the war.\n- Summative: Civil War timeline and map worksheet accuracy.\n- Quiz (to be given next class):\n  1. What were the two sides in the Civil War? (Union/North and Confederacy/South)\n  2. What was the main issue that divided the North and South? (Slavery)\n  3. Who was the President of the United States during the Civil War? (Abraham Lincoln)",
            "options": [],
            "correctAnswer": "",
            "points": 0
          }
        ]
      }
    ]
  },
  "game_type": "platformer",
  "template_code": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Kaplay Platformer Template</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            background: #1a1a2e;\n            overflow: hidden;\n        }\n\n        canvas {\n            display: block;\n        }\n    </style>\n</head>\n\n<body>\n    <script src=\"https://unpkg.com/kaplay@3001.0.19/dist/kaplay.js\"></script>\n    <script>\n        // ============================================================\n        //  KAPLAY.JS PLATFORMER TEMPLATE\n        //  A simple, customizable foundation for any 2D platformer.\n        //  Uses built-in Kaplay sprites & shapes \u2014 no external assets.\n        // ============================================================\n\n        // ----- 1. GAME CONFIG (tweak these!) -----\n        // This object holds all user-tweakable constants.\n        // Keeping them in one place makes it easy to balance gameplay without hunting through code.\n        const CONFIG = {\n            // Physics\n            gravity: 1600, // Gravity force applied to all bodies (pixels/sec^2)\n            jumpForce: 650,  // Initial velocity for jumps\n            moveSpeed: 300,  // Horizontal movement speed\n            maxFallSpeed: 800,  // Cap on downward velocity to prevent \"tunneling\" through floors\n\n            // Player\n            playerStartPos: { x: 50, y: 0 }, // Default spawn point if level data is missing '@'\n            playerHealth: 3,    // Starting HP\n\n            // Camera\n            cameraFollow: true, // Whether the camera tracks the player\n\n            // Visuals\n            // Using a designated palette keeps the game looking consistent.\n            bgColor: [18, 18, 42],\n            floorColor: [60, 180, 120],\n            platformColor: [80, 140, 200],\n            hazardColor: [220, 60, 80],\n            coinColor: \n... [truncated, 17132 chars total]",
  "game_design_doc": "GAME_TYPE: platformer\n\nRATIONALE: A platformer is ideal for history because it allows for a chronological progression through time. The level design can physically represent a timeline, moving the player from the causes of the war in the early stages to the key battles and eventually the resolution.\n\nADDON FEATURE: The Fact-Check Bridge\nAt three specific points in each level, the player reaches a gap that can only be crossed by jumping onto one of two floating platforms. Each platform is labeled with a statement (e.g., Platform A: \"The Union supported slavery\" vs. Platform B: \"The Confederacy supported slavery\"). If the player lands on the historically accurate platform, it stays solid and allows them to cross; if they land on the incorrect one, it vanishes, and the player falls to a lower checkpoint where they must re-read a \"History Scroll\" to try again.\n\nVISUAL THEME: The game is set in the 1860s, featuring a \"parchment paper\" aesthetic for the background. The player character is a stylized Union scout traveling through environments that transition from the industrial North (brick factories and telegraph lines) to the agrarian South (fields and fences) as the levels progress.",
  "design_feedback": "1. **Genre Fit**: 5/5 - The platformer's linear progression perfectly mirrors a historical timeline, moving students physically through the chronological events of the war.\n2. **Pedagogical Alignment**: 4/5 - The bridge mechanic effectively tests the lesson's specific objectives regarding the differences between the Union and Confederacy through binary choice-making.\n3. **Addon Feasibility**: 5/5 - Implementing label-based collision logic in Kaplay.js is a straightforward modification of standard platformer mechanics and fits within a manageable scope.\n4. **Visual Theme Coherence**: 5/5 - The parchment aesthetic and the transition from industrial North to agrarian South provide strong visual reinforcement of the lesson's content on economic differences.\n5. **Fun Factor**: 4/5 - While the fall-back mechanic is punitive, it ensures players engage with the educational content without breaking the core platforming loop.\n\nDECISION: PASS",
  "design_approved": true,
  "implementation_plan": "This technical plan outlines the visual transformation of the platformer template into a Civil War-themed educational game and the implementation of the \"Fact-Check Bridge\" mechanic.\n\n### 1. Visual Reskin Plan\n\nThe goal is to move from a generic neon platformer to a \"historical parchment\" aesthetic.\n\n#### **Global Visuals (CONFIG Object)**\n*   **Background Color**: Change `CONFIG.bgColor` from dark blue to `[245, 235, 205]` (Parchment).\n*   **Palette Swap**:\n    *   `floorColor`: Level 1 (North) `[80, 50, 40]` (Industrial Brick); Level 2 (South) `[130, 90, 60]` (Southern Soil).\n    *   `hazardColor`: `[80, 80, 80]` (Iron/Grey for Barbed Wire or Cannonballs).\n    *   `coinColor`: `[184, 134, 11]` (Aged Gold for \"Telegraph Keys\").\n\n#### **Character & Object Reskin**\n*   **The Scout (Player)**: In `scene(\"game\")`, modify the player creation. Instead of the default bean, add a `color(0, 50, 150)` (Union Blue) and `outline(2, rgb(0, 0, 0))` to signify the Union uniform.\n*   **Telegraph Keys (Coins)**: Change \"Coins\" to \"Messages\" in `scoreLabel`. Replace the `circle(10)` in `buildLevel` (case `$`) with a `rect(16, 12)` to look like a telegraph key or a folded letter.\n*   **Barbed Wire (Hazards)**: The `polygon` in `buildLevel` (case `^`) will remain, but the color change to metallic grey and the parchment background will make them look like sharp fortifications.\n*   **The Peace Treaty (Portal)**: Change `CONFIG.portalColor` to `[255, 255, 255]` with a dark outline to represent an official document.\n\n#### **HUD & UI Updates**\n*   `hpLabel`: Change text to \"Morale: ${hp}\".\n*   `scoreLabel`: Change text to \"Messages: ${score}\".\n*   `levelLabel`: Level 1 becomes \"The Industrial North\"; Level 2 becomes \"The Agrarian South\".\n\n---\n\n### 2. Addon Mechanic Implementation Plan: Fact-Check Bridge\n\nThis mechanic will be implemented using a new tile symbol and a dynamic question-spawner.\n\n#### **Step 1: Data Structure**\nDefine the historical content at the top of the script:\n```javasc\n... [truncated, 4656 chars total]",
  "game_code": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>The Union Scout: Timeline Runner</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            background: #2c2c2c;\n            overflow: hidden;\n            font-family: 'Courier New', Courier, monospace;\n        }\n\n        canvas {\n            display: block;\n            margin: 0 auto;\n        }\n    </style>\n</head>\n\n<body>\n    <!-- KAPLAY.js CDN -->\n    <script src=\"https://unpkg.com/kaplay@3001/dist/kaplay.js\"></script>\n    <script>\n        // ============================================================\n        //  THE UNION SCOUT: TIMELINE RUNNER\n        //  A Civil War themed platformer with historical fact-checking.\n        // ============================================================\n\n        /**\n         * EDUCATIONAL OBJECTIVES:\n         * 1. Identify key political and military figures of the Civil War.\n         * 2. Distinguish between Union and Confederate states/ideologies.\n         * 3. Understand the chronological progression of the war.\n         */\n\n        // ----- 1. GAME DATA: HISTORY FACTS -----\n        const BRIDGES = [\n            {\n                q: \"Who was the President of the Union?\",\n                a: { text: \"Abraham Lincoln\", isCorrect: true },\n                b: { text: \"Jefferson Davis\", isCorrect: false }\n            },\n            {\n                q: \"Which side fought to end slavery?\",\n                a: { text: \"The Confederacy\", isCorrect: false },\n                b: { text: \"The Union\", isCorrect: true }\n            },\n            {\n                q: \"The war effectively ended at...\",\n                a: { text: \"Appomattox Court\", isCorrect: true },\n                b: { text: \"Bull Run\", isCorrect: false }\n            }\n        ];\n\n        // ----- 2. GAME CONFIGURATION -----\n      \n... [truncated, 21933 chars total]",
  "documentation": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>The Union Scout: Timeline Runner</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            background: #2c2c2c;\n            overflow: hidden;\n            font-family: 'Courier New', Courier, monospace;\n        }\n\n        canvas {\n            display: block;\n            margin: 0 auto;\n        }\n    </style>\n</head>\n\n<body>\n    <!-- KAPLAY.js CDN -->\n    <script src=\"https://unpkg.com/kaplay@3001/dist/kaplay.js\"></script>\n    <script>\n        // ============================================================\n        //  THE UNION SCOUT: TIMELINE RUNNER\n        //  A Civil War themed platformer with historical fact-checking.\n        // ============================================================\n\n        /**\n         * EDUCATIONAL OBJECTIVES:\n         * 1. Identify key political and military figures of the Civil War.\n         * 2. Distinguish between Union and Confederate states/ideologies.\n         * 3. Understand the chronological progression of the war.\n         */\n\n        // ----- 1. GAME DATA: HISTORY FACTS -----\n        const BRIDGES = [\n            {\n                q: \"Who was the President of the Union?\",\n                a: { text: \"Abraham Lincoln\", isCorrect: true },\n                b: { text: \"Jefferson Davis\", isCorrect: false }\n            },\n            {\n                q: \"Which side fought to end slavery?\",\n                a: { text: \"The Confederacy\", isCorrect: false },\n                b: { text: \"The Union\", isCorrect: true }\n            },\n            {\n                q: \"The war effectively ended at...\",\n                a: { text: \"Appomattox Court\", isCorrect: true },\n                b: { text: \"Bull Run\", isCorrect: false }\n            }\n        ];\n\n        // ----- 2. GAME CONFIGURATION -----\n      \n... [truncated, 21933 chars total]",
  "playtest_report": "# Game Evaluation Report: The Union Scout: Timeline Runner\n\n## 1. Static Analysis\n**Score: 4/5**\n- **HTML Structure:** Valid. \n- **CDN:** Uses `kaplay@3001`, which is the correct current version.\n- **Syntax:** No syntax errors found.\n- **Definitions:** All game objects, components, and tags used in `onCollide` and `add` are properly initialized.\n- **Warning Check:** The runtime test flagged `camPos` as deprecated. In Kaplay v3001, `setCamPos` and `getCamPos` are the preferred methods.\n\n## 2. Code Quality Review\n**Score: 3/5**\n- **Initialization:** `kaplay()` config is well-defined with appropriate `buttons` mapping.\n- **Scene Management:** Scenes (`game`, `gameover`, `win`) are correctly defined.\n- **Logic Issues:**\n    - **Deprecation:** The use of `camPos()` as both a getter and setter is deprecated in the current version of the library.\n    - **Brittle Indexing:** The `qIndex` logic in `buildLevel` (using `1 + bridgeCounter`) is functional for the current 3-question array but would break immediately if level layouts were changed or expanded.\n- **Performance:** The \"GPU stall\" warning in the headless browser is likely an environment artifact, but the code uses many `add()` calls inside the nested level loops without clearing previous assets (though `go()` handles scene clearing).\n\n## 3. Educational Alignment\n**Score: 5/5**\n- **GDD Match:** Perfectly implements the \"Fact-Check Bridge\" mechanic and \"History Scroll\" checkpointing described in the GDD.\n- **Learning Objectives:** The questions directly address the presidency of the Union vs. Confederacy and the ideological/geographical differences.\n- **Integration:** The \"History Scroll\" (checkpoint) and \"Fact-Check Bridge\" (knowledge gate) are well-integrated into the gameplay loop rather than being tacked-on overlays.\n\n## 4. Playability Assessment\n**Score: 3/5**\n- **State Transition:** Clear start, death, and victory states.\n- **Controls:** **ISSUE:** While controls are defined in the `buttons` config, they are **not\n... [truncated, 3631 chars total]",
  "ship_approved": true,
  "errors": [
    ")"
  ],
  "design_iteration": 1,
  "code_iteration": 1,
  "status": "done"
}