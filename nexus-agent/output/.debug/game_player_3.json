{
  "lesson_plan": {
    "lessonPlan": {
      "title": "Introduction to Photosynthesis",
      "duration": "60 minutes",
      "gradeLevel": "Level: 5th Grade",
      "subject": "Science",
      "objectives": [
        "Students will be able to define photosynthesis.",
        "Students will identify the inputs (sunlight, water, carbon dioxide) and outputs (oxygen, glucose) of photosynthesis.",
        "Students will explain the importance of photosynthesis for life on Earth."
      ],
      "standards": [
        "NGSS 5-LS1-1: Support an argument that plants get the materials they need for growth chiefly from air and water."
      ],
      "materials": [
        "Could not extract materials"
      ],
      "content": {
        "introduction": "Could not extract introduction",
        "procedure": "Could not extract procedure",
        "closure": "Could not extract closure"
      }
    },
    "rubrics": {
      "title": "Extracted Rubric",
      "criteria": []
    },
    "assessments": [
      {
        "type": "Extracted Assessment",
        "title": "Assessment",
        "questions": [
          {
            "questionText": "- Formative: participation in Thumbs Up/Thumbs Down.\n- Summative: Plant diagram worksheet accuracy.\n- Quiz (to be given next class):\n  1. What gas do plants take in? (Carbon Dioxide)\n  2. What gas do plants release? (Oxygen)\n  3. What is the main source of energy for plants? (Sunlight)",
            "options": [],
            "correctAnswer": "",
            "points": 0
          }
        ]
      }
    ]
  },
  "game_type": "shootemup",
  "template_code": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Kaplay Shoot 'em Up Template</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n        }\n\n        body {\n            background: #000;\n            overflow: hidden;\n        }\n\n        canvas {\n            display: block;\n        }\n    </style>\n</head>\n\n<body>\n    <script src=\"https://unpkg.com/kaplay@3001.0.19/dist/kaplay.js\"></script>\n    <script>\n        // =============================================\n        //  SHOOT 'EM UP TEMPLATE \u2014 Kaplay.js\n        //  Arrow keys / WASD move, Z / Space to shoot\n        //\n        //  ARCHITECTURE:\n        //    Two scenes: \"game\" (main gameplay) and \"gameover\" (score display + retry).\n        //    Tags used: \"star\", \"player\", \"pbullet\" (player bullets), \"enemy\", \"ebullet\" (enemy bullets).\n        //    Difficulty scales with score \u2014 spawn rate increases over time.\n        //    Player has HP + invulnerability frames on hit. Three enemy types: basic, fast (zigzag), tank (shoots back).\n        // =============================================\n\n        // -- CONFIG: All tunable gameplay constants live here --\n        const C = {\n            playerSpeed: 280,\n            bulletSpeed: 600,\n            fireRate: 0.12,       // seconds between player shots (lower = faster)\n            playerHP: 5,\n            spawnRate: 1.2,       // base seconds between enemy spawns (divided by difficulty multiplier)\n            enemySpeed: [80, 200],  // [min, max] for rand()\n            enemyHP: [1, 3],\n            enemyFireRate: 1.5,   // seconds between tank enemy shots\n            enemyBulletSpd: 250,\n            bg: [6, 6, 18],\n            playerCol: [80, 220, 255],\n            bulletCol: [255, 255, 120],\n            enemyBulletCol: [255, 100, 100],\n        };\n\n        // -- INIT: 480x700 portrait canvas, letterboxed to fit window --\n        kaplay({ width: 480, height: 700, background: C.bg, crisp: true, letterbox: true });\n        l\n... [truncated, 13505 chars total]",
  "game_design_doc": "GAME_TYPE: shootemup\n\nRATIONALE: The shootemup template is ideal for photosynthesis because the process involves \"capturing\" specific elements (inputs) and \"releasing\" others (outputs). The fast-paced nature of the genre helps students rapidly differentiate between the various molecules and energy sources involved in the process through repetitive recognition.\n\nADDON FEATURE: The Synthesis Gauge\nThe player's character (a green leaf) has a three-part \"Synthesis Gauge\" representing Sunlight, Water, and Carbon Dioxide. Floating icons for all three inputs appear among the enemies; the player must shoot or collide with these specific icons to fill the corresponding segment of the gauge. Once all three inputs are collected, the leaf automatically releases a \"Glucose Blast\" (a powerful screen-clearing attack) and releases Oxygen particles, reinforcing the concept that these specific inputs are required to produce the plant's food and life-sustaining byproduct.\n\nVISUAL THEME: The game is set in a vibrant \"Garden Micro-World\" where the player controls a \"Super-Leaf\" soaring through the air. Enemies are represented as \"Pollution Clouds\" and \"Hungry Aphids,\" while the background transitions from a dark soil-level view to a bright, sun-drenched sky as the player progresses.",
  "design_feedback": "1. **Genre Fit (4/5)**: The shootemup genre provides a high-energy environment for rapid identification, though the distinction between \"shooting\" enemies and \"collecting\" inputs needs careful UI handling to avoid confusion.\n2. **Pedagogical Alignment (5/5)**: The Synthesis Gauge perfectly mirrors the chemical equation of photosynthesis by requiring all three specific inputs to produce the resulting outputs.\n3. **Addon Feasibility (5/5)**: Implementing a segmented gauge and a screen-clearing \"bomb\" effect is well within the technical scope of modifying a Kaplay.js shootemup template.\n4. **Visual Theme Coherence (5/5)**: The \"Garden Micro-World\" and \"Super-Leaf\" protagonist create an immediate and intuitive link to the botanical subject matter.\n5. **Fun Factor (5/5)**: Linking the educational goal (collecting inputs) to a powerful gameplay reward (the Glucose Blast) ensures the learning mechanic is the most exciting part of the game.\n\nDECISION: PASS",
  "design_approved": true,
  "implementation_plan": "This technical plan outlines the transformation of the Shoot 'em Up template into an educational photosynthesis game.\n\n### 1. Visual Reskin Plan\n\nThe \"Garden Micro-World\" theme involves transitioning from a soil-based environment to a bright, sun-lit sky.\n\n| Object | Current (Template) | New (Photosynthesis Theme) | Changes (Code/Visuals) |\n| :--- | :--- | :--- | :--- |\n| **Player** | `sprite(\"bean\")` | **Super-Leaf** | Use `color(40, 200, 40)` (Green). Add a `text(\"LEAF\")` child for identification. |\n| **Basic Enemy** | Red `rect` | **Pollution Cloud** | Change `col` to `[100, 100, 100]` (Gray). Increase size slightly. |\n| **Fast Enemy** | Yellow `rect` | **Hungry Aphid** | Change `col` to `[180, 200, 50]` (Light Green). Keep zigzag movement. |\n| **Tank Enemy** | Purple `rect` | **Industrial Smog** | Change `col` to `[50, 20, 80]` (Dark Purple). Shoots \"Toxin\" bullets. |\n| **P-Bullet** | Yellow `rect` | **Energy Pulse** | Change `bulletCol` to `[255, 255, 200]` (Bright White/Yellow). |\n| **E-Bullet** | Red `circle` | **Toxin Drop** | Change `enemyBulletCol` to `[80, 50, 20]` (Brown). |\n| **Background** | Dark Blue `[6, 6, 18]` | **The Garden** | Set initial `bg` to `[60, 40, 20]` (Soil). In `onUpdate`, lerp color toward `[135, 206, 235]` (Sky Blue) based on score. |\n| **Stars** | White `circle` | **Pollen/Air Bubbles** | Change `color` to `[255, 255, 200]` with lower opacity and varied `s` (size). |\n| **HUD Text** | Score/Hearts | **Energy/Vitality** | Rename \"Score\" to \"Sugar Produced\". Change heart symbols to small leaf symbols `\"\ud83c\udf3f\"`. |\n\n---\n\n### 2. Addon Mechanic Implementation Plan: The Synthesis Gauge\n\nThis mechanic adds a collection loop that rewards the player with a screen-clearing \"Glucose Blast.\"\n\n#### A. State Variables\nAdd this inside the `scene(\"game\")` scope:\n```javascript\nconst synthesis = {\n    sunlight: false,\n    water: false,\n    co2: false,\n};\nconst gaugeColors = { sunlight: [255, 255, 0], water: [0, 100, 255], co2: [150, 150, 150] };\n```\n\n#### \n... [truncated, 4868 chars total]",
  "game_code": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Photosynthesis Defender</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n        }\n\n        body {\n            background: #222;\n            overflow: hidden;\n        }\n\n        canvas {\n            display: block;\n            margin: 0 auto;\n        }\n    </style>\n</head>\n\n<body>\n    <!-- KAPLAY.js CDN -->\n    <script src=\"https://unpkg.com/kaplay@3001/dist/kaplay.js\"></script>\n    <script>\n        /**\n         * PHOTOSYNTHESIS DEFENDER\n         * \n         * EDUCATIONAL MAPPING:\n         * 1. INPUTS: Player collects Sunlight (Yellow), Water (Blue), and CO2 (Gray).\n         * 2. OUTPUTS: Collecting all three triggers \"Glucose Blast\" (Sugar) and releases Oxygen (Particles).\n         * 3. PROCESS: Visualizes the transformation of raw materials into energy within a plant.\n         */\n\n        // -- CONFIG --\n        const C = {\n            playerSpeed: 300,\n            bulletSpeed: 650,\n            fireRate: 0.12,\n            playerHP: 5,\n            spawnRate: 1.1,\n            enemySpeed: [90, 220],\n            enemyHP: [1, 4],\n            enemyFireRate: 1.5,\n            bgStart: [60, 40, 20],   // Soil Dark Brown\n            bgEnd: [135, 206, 235], // Sky Blue\n            // Colors\n            playerCol: [40, 200, 40],     // Leaf Green\n            bulletCol: [255, 255, 200],   // Energy Pulse (Light Yellow)\n            enemyBulletCol: [80, 50, 20], // Toxin (Brown)\n            inputColors: {\n                sunlight: [255, 220, 0],\n                water: [0, 100, 255],\n                co2: [150, 150, 150]\n            }\n        };\n\n        // Initialize Kaplay\n        kaplay({\n            width: 480,\n            height: 700,\n            background: C.bgStart,\n            crisp: true,\n            letterbox: true,\n        });\n\n        // -- ASSETS & UTILS --\n\n        // Background Layer: Soil to Sky transition\n        function makeBackground() {\n            con\n... [truncated, 20120 chars total]",
  "documentation": "<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Photosynthesis Defender</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n        }\n\n        body {\n            background: #222;\n            overflow: hidden;\n        }\n\n        canvas {\n            display: block;\n            margin: 0 auto;\n        }\n    </style>\n</head>\n\n<body>\n    <!-- KAPLAY.js CDN -->\n    <script src=\"https://unpkg.com/kaplay@3001/dist/kaplay.js\"></script>\n    <script>\n        /**\n         * PHOTOSYNTHESIS DEFENDER\n         * \n         * EDUCATIONAL MAPPING:\n         * 1. INPUTS: Player collects Sunlight (Yellow), Water (Blue), and CO2 (Gray).\n         * 2. OUTPUTS: Collecting all three triggers \"Glucose Blast\" (Sugar) and releases Oxygen (Particles).\n         * 3. PROCESS: Visualizes the transformation of raw materials into energy within a plant.\n         */\n\n        // -- CONFIG --\n        const C = {\n            playerSpeed: 300,\n            bulletSpeed: 650,\n            fireRate: 0.12,\n            playerHP: 5,\n            spawnRate: 1.1,\n            enemySpeed: [90, 220],\n            enemyHP: [1, 4],\n            enemyFireRate: 1.5,\n            bgStart: [60, 40, 20],   // Soil Dark Brown\n            bgEnd: [135, 206, 235], // Sky Blue\n            // Colors\n            playerCol: [40, 200, 40],     // Leaf Green\n            bulletCol: [255, 255, 200],   // Energy Pulse (Light Yellow)\n            enemyBulletCol: [80, 50, 20], // Toxin (Brown)\n            inputColors: {\n                sunlight: [255, 220, 0],\n                water: [0, 100, 255],\n                co2: [150, 150, 150]\n            }\n        };\n\n        // Initialize Kaplay\n        kaplay({\n            width: 480,\n            height: 700,\n            background: C.bgStart,\n            crisp: true,\n            letterbox: true,\n        });\n\n        // -- ASSETS & UTILS --\n\n        // Background Layer: Soil to Sky transition\n        function makeBackground() {\n            con\n... [truncated, 20120 chars total]",
  "playtest_report": "# QA Evaluator Report: Photosynthesis Defender\n\n## 1. Static Analysis\n**Score: 3/5**\n- **HTML Structure:** Valid.\n- **CDN Link:** Correct (Kaplay v3001).\n- **JavaScript Syntax:** Generally valid, but contains logic errors regarding component dependencies and missing variable definitions.\n- **Reference Integrity:** Found a major reference error: `C.enemyBulletSpd` is used in the `spawnEnemy` function but is never defined in the `C` configuration object.\n\n## 2. Code Quality Review\n**Score: 2/5**\n- **Initialization:** `kaplay()` and `scene()` are set up correctly.\n- **Fatal Runtime Error:** The headless browser correctly identified a crash: `Component \"lifespan\" requires component \"opacity\"`. In Kaplay.js, any object using `lifespan()` must also have an `opacity()` component because the lifespan utility often manipulates the alpha channel for fading. This occurs in three places:\n    1. The \"Glucose Produced\" text in `triggerGlucoseBlast`.\n    2. The \"Collected!\" feedback text in the player/input collision.\n    3. The white hit-particles in the bullet/enemy collision.\n- **Variable Scoping:** `C.enemyBulletSpd` is undefined, which will cause a crash as soon as a \"smog\" enemy attempts to fire a projectile.\n\n## 3. Educational Alignment\n**Score: 5/5**\n- **GDD Match:** Perfectly matches the \"Synthesis Gauge\" and \"Glucose Blast\" requirements.\n- **Learning Objectives:** Highly visible. The transformation of Sunlight, Water, and CO2 into Sugar/Oxygen is the core mechanic.\n- **Visual Mapping:** The transition from soil to sky (via background color lerping) is a clever touch for representing plant growth/progression.\n\n## 4. Playability Assessment\n**Score: 3/5**\n- **States:** Clear game, gameover, and restart logic.\n- **Controls:** Multi-input (WASD/Arrows/Space/Z) is well-implemented.\n- **Readability:** UI gauge is clear.\n- **Critical Issue:** The game will crash during the first \"Glucose Blast\" or upon collecting an item due to the `lifespan` component error.\n\n---\n\n## Final Verd\n... [truncated, 3241 chars total]",
  "ship_approved": false,
  "errors": [
    "Error: Component \"lifespan\" requires component \"opacity\"\n    at Object.d (https://unpkg.com/kaplay@3001/dist/kaplay.js:56:20785)\n    at n (https://unpkg.com/kaplay@3001/dist/kaplay.js:53:781)\n    at https://unpkg.com/kaplay@3001/dist/kaplay.js:53:1021\n    at rn.forEach (<anonymous>)\n    at re.trigger (https://unpkg.com/kaplay@3001/dist/kaplay.js:53:1003)\n    at ze.trigger (https://unpkg.com/kaplay@3001/dist/kaplay.js:53:1445)\n    at Object.trigger (https://unpkg.com/kaplay@3001/dist/kaplay.js:56:23666)\n    at Object.add (https://unpkg.com/kaplay@3001/dist/kaplay.js:56:18358)\n    at file:///tmp/tmpyj5ckdzp.html:511:17\n    at https://unpkg.com/kaplay@3001/dist/kaplay.js:56:15641",
    "1. **DEPENDENCY ERROR:** `LIFESPAN()` COMPONENT USED WITHOUT `OPACITY()`. KAPLAY REQUIRES THE OBJECT TO HAVE `OPACITY()` TO TRACK THE FADE-OUT LOGIC.",
    "*AFFECTED OBJECTS:* \"GLUCOSE PRODUCED\" TEXT, \"COLLECTED!\" TEXT, AND HIT-SPARK RECTANGLES.",
    "2. **REFERENCE ERROR:** `C.ENEMYBULLETSPD` IS REFERENCED IN THE ENEMY SHOOTING LOGIC BUT IS MISSING FROM THE `CONST C` CONFIGURATION BLOCK.",
    "3. **LOGIC FLAW:** IN `ONCOLLIDE(\"PBULLET\", \"ENEMY\")`, THE CODE ATTEMPTS TO SET `E.COLOR = WHITE` BUT THEN SETS IT TO `RGB(100,100,100)` AFTER A WAIT. THIS OVERWRITES THE ORIGINAL ENEMY COLOR (WHICH VARIES BY TYPE) PERMANENTLY, TURNING ALL ENEMIES GRAY AFTER ONE HIT."
  ],
  "design_iteration": 1,
  "code_iteration": 2,
  "status": "coding"
}